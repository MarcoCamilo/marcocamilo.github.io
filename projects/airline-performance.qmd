---
title: Airline On-Time EDA
subtitle: Exploring Airline Performance from 2 Million Flights across 30 Years
description: Explore a data-driven journey into predicting and mitigating customer churn with this project on predictive analytics. Leveraging a Random Forest Classifier, discover insights that empower businesses to proactively retain customers and enhance overall satisfaction.
featured: 2
image: "![](https://i.dailymail.co.uk/i/pix/2013/05/02/article-2318173-19957F94000005DC-90_964x639.jpg)"
category: Exploratory Data Analysis
type: EDA
skills:
    - Pandas
    - NumPy
    - Matplotlib
    - Seaborn
    - Dashboarding
---

{{< meta image >}}

## Executive Summary

This project analyzes on-time performance trends from 30 years of US domestic flight data, focusing on variations across carriers, routes, airports, and time. The goal is to conduct a comprehensive exploratory data analysis (EDA) to address key industry questions, such as identifying carriers and airports with the highest frequency of flight delays, understanding the impact of departure delays on arrival times, and examining trends in flight delays within the US aviation sector. The findings from the EDA will be translated into an interactive visualization dashboard using Streamlit.

## Dataset

The [Airline Reporting Carrier On-Time Performance Dataset](https://www.transtats.bts.gov/Fields.asp?gnoyr_VQ=FGJ), sourced from the U.S. Department of Transportation's Bureau of Transportation Statistics, contains scheduled and actual departure and arrival times reported by certified U.S. air carriers between 1987 and 2020. The version used in this project, available at [IBM Developer](https://developer.ibm.com/exchanges/data/all/airline/)^[The dataset is available in three sizes: the original dataset of 194,385,636 flights, a 2 million sample version and a 2 thousand sample of flights from LAX to JFK airport. All three versions are available as gzip compressed tar or csv files.], contains a 2 million record sample of the full dataset (<1%).

Key features reported by carriers include scheduled and actual event times, flight dates, carrier, origin and destination information, cancelation and diversion information, as well as summary statistics such as elapsed time, distance and delay causes. A full description of the variables in the dataset can be found [here](https://www.transtats.bts.gov/Fields.asp?gnoyr_VQ=FGJ). Below is a summary of the main variable grouppings.

<details>
  <summary>Feature glossary</summary>

- **Temporal variables**: `Year`, `Quarter`, `Month`, `DayofMonth`, `DayOfWeek`, `FlightDate`
- **Flight variables**: `Reporting_Airline`, `Tail_Number`, `Flight_Number_Reporting_Airline`
- **Origin/Destination variables**: 
-   `OriginAirportID`, `Origin`, `OriginCityName`, `OriginState`, `OriginStateName`,   
-   `DestAirportID`, `Dest`, `DestCityName`, `DestState`, `DestStateName`  
- **Departure/Arrival time variables**: 
-   `CRSDepTime`, `DepTime`, `DepDelay`, `DepDelayMinutes`, `DepDel15`, `DepartureDelayGroups`  
-   `CRSArrTime`, `ArrTime`, `ArrDelay`, `ArrDelayMinutes`, `ArrDel15`, `ArrivalDelayGroups`  
- **Taxi variables**: `TaxiOut`, `WheelsOff`, `WheelsOn`, `TaxiIn`
- **Cancellation variables**: `Cancelled`, `CancellationCode`, `Diverted`
- **Flight summary variables**: `CRSElapsedTime`, `ActualElapsedTime`, `AirTime`, `Flights`, `Distance`, `DistanceGroup`
- **Cause of Delay (Data starts 6/2003)**: `CarrierDelay`, `WeatherDelay`, `NASDelay`, `SecurityDelay`, `LateAircraftDelay`

</details>

## Preprocessing and Feature Engineering

The strategy for preprocessing interleaves *univariate analysis* with *data cleaning and feature engineering* for each variable group, utilizing the former to contextualize preprocessing decisions in the latter. For this project, this approach encompases three major aspects: conducting a general univariate analysis, preprocessing flight info variables, and (re)engineering time variables.

### Univariate Analysis

For each variable group, I conducted a univariate analysis to understand the distribution, spread, and missing values of the variables using two custom functions:

<details class="list">
  <summary>`df_overview` prints the shape, sample head and tail, and non-null counts.</summary>
```python
def df_overview(df):
    print(f"Shape: {df.shape}\n")
    print(f"Head and tail preview:")
    display(df)
    print(f"Df info:")
    print(df.info(verbose=True), "\n")
    print("-"*70)
```
</details>

<details class="list">
<summary>`univariate_preview` provides a compact report with the first five rows, data types, unique values, top 5 values, null value percentage, and summary statistics for continuous variables.</summary>

```python
def univariate_preview(df, cols, describe=True):
    display("Data Preview")
    display(df[cols].head())
    
    display("Value Counts")
    list = []
    for col in cols:
        list.append(
            [col,
            df[col].dtypes,
            df[col].nunique(),
            df[col].value_counts().iloc[:5].index.tolist(),
            "{:.2f}%".format(df[col].isna().mean()*100)]
            )
    display(pd.DataFrame(list, 
                         columns = ['columns', 'dtypes', 'nunique', 'top5', 'na%']
                         ).sort_values('nunique', ascending=False))
    
    if describe:
        display("Summary Stats")
        display(pd.concat([
            df[cols].describe(),
            df[cols].skew().to_frame('skewness').T,
            df[cols].kurtosis().to_frame('kurtosis').T,
        ]))
```

</details>

Additionally, I visualized missing values using the `missingno` package^[The `missingno` package offers visualization options such as heatmaps, bar charts, and dendrograms to identify patterns and distributions of missing data.], while certain distributions and value counts I visualized using `matplotlib` and `seaborn`.

### Preprocessing Flight Info Variables

The first half of all preprocessing focused on the flight information variables, including date, flight, origin/destination, and departure/arrival variables. Based on the findings of each univariate analysis, I performed the following preprocessing steps:

- **Data Cleaning**
  - **`FlightDate` to `datetime64[ns]`**: allowed to perform date operations, aggregations, and visualizations.
  - **Filling Missing State and State Names**: imputed missing state and state name values to reduce missing data.
  - **Standardizing City Names**: standardized city names to ensure uniformity and remove single occurrences.
  - **Dropping Taxi, Cancelled, and Diverted Variables**: removed variables due to high occurrence of missing values.
- **Feature Engineering**
  - **Airline Names**: used an airlines dataset to map the airline codes to their respective airline names to provide more readable and insightful information.
  - **Unique Flight Identifier**: explored creating a unique flight identifier by combining carrier code and flight number, to reduce ambiguity and identify unique flights more easily.

### (Re)Engineering Time Variables

The second phase of preprocessing addresses a critical issue found in the dataset's handling of time-related variables, particularly concerning flight delays. The delay variables were calculated from the raw timestamps, without accounting for time zone discrepancies, daylight savings time, and cross-midnight flights. This required developing an approach to impute time zone information, correct timestamps, and recompute delays accurately.

To address these issues, I implemented the following steps:

1. **Imputing Time Zone Information**: assigned time zones to all timestamps using a dictionary of airport codes and their respective time zones sourced from two datasets.
2. **Reverse Engineering Arrival Dates**: converted all times to UTC (Coordinated Universal Time), recalculated timestamps based on flight departure dates and time differences, and reconverted times to local time zones.
3. **Filter Remaining Negative Delays**: removed the remaining negative delays after the reverse engineering process to ensure accurate delay calculations.
4. **Delay Calculation**: calculated delays based on the difference between scheduled and actual departure and arrival times, accounting for time zone differences and daylight savings time.

In addition to this, I also performed the following data cleaning and feature engineering steps:

- **Data Cleaning**:
  - **Standardizing 0s, 2400s, and missing values**: converted 0s to Nan values and 2400s to 0s for consistency in time representation.
  - **Filling Missing CRS Values**: imputed missing values in the CRS (Scheduled) times from the difference between actual times and delay minutes.
  - **Changing Data Types**: converted data types where necessary to improve computational efficiency.
- **Feature Engineering**:
  - **Datetime Conversion**: created UTC versions of time variables for time calculations such as elapsed time.
  - **Time Recalculations**: using the time zone marked timestamps, recalculated delays and elapsed times more accurately than the original dataset.

<!-- Explain why discrepancies still remained and say these will be removed later in the analysis -->

## Exploratory Data Analysis

The Exploratory Data Analysis in this project was carried in two modalities: a methodical univariate analysis of each variable during preprocessing and a targeted bivariate and multivariate analysis focused on answering the research questions of the project. I framed the questions around five distinct themes: 

1. **Longitudinal**: How do delays vary across time?
2. **Corporate**: How do delays vary across carriers? (distribution and longitudinal)
3. **Directional**: How do delays vary by route?
4. **Geographical**: how do delays vary by airport?
5. **Correlation**: are departures delays correlated with arrival delays? (or how frequent do flights make up for late departures?)

Before diving into the findings for each question, I will provide a brief overview of the findings from the univariate analysis. 

### Univariate Analysis

The univariate analysis revealed several key insights about the dataset:

<details class="list">
<summary>**Date columns**: The flights span 34 years, with the distribution slightly shifted left (2005), indicating growth in the airline industry in the last 15 years. Other columns such as months, days, and weekdays, show an even distribution.</summary>
  ![](/assets/projects/airline/date_cols.png)
</details>

<details class="list">
<summary>**Flight info columns**: The dataset includes 33 unique carriers, with Southwest Airlines (WN), Delta Air Lines (DL), and American Airlines (AA) being the most frequent.</summary>
  ![](/assets/projects/airline/carrier-count.png)
</details>

<details class="list">
  <summary>**Origin/Destination columns**: Flights originate and land in all 50 US states and five overseas territories, including Puerto Rico, US Virgin Islands, and Guam. The top destinations in the dataset are California (CA), Texas (TX), Florida (FL), Illinois (IL), Georgia (GA), and New York (NY).</summary>
  ![](/assets/projects/airline/state-count.png)
</details>

<details class="list">
  <summary>**Time Variables**: Departures are more frequent in the morning hours, while arrivals peak in the evening. The distribution of CRS and actual time variables for departures and arrivals are almost identical, indicating that the average size of flight delays is small across the dataset.</summary>
  ![](/assets/projects/airline/time-distribution.png)
</details>

<details class="list">
  <summary>**Delay Variables**: Approximately 80% of flights operate on-time, while around 20% experience delays (as by the industry-defined standard of exceeding 15 minutes). The distribution shows a right skew, with over 40% of flights arriving early by less than 15 minutes and about 30% arriving exactly on time. Out of all delayed flights, most fall within the 15 to 40-minute range.</summary>
![](/assets/projects/airline/delay-cols.png)
</details>

<details class="list">
  <summary>**Flight Summary Variables**: Flights typically cover distances under 1000 miles, with a right-skewed distribution observed in the data. The majority of flights have durations under around 160 minutes or 2 hours and 40 minutes, as indicated by the right-skewed distributions of the elapsed time variables.</summary>
![](/assets/projects/airline/flight-summary-cols.png)
</details>

<!-- <details class="list"> -->
<!-- <summary>**Delay Summary Variables**: The amount of delays across all causes show a right-skewed distribution, with most factors causing delays of less than 200 minutes. The highest recorded delay values approach approximately 1600 minutes, with SecurityDelay showing the smallest maximum delay of 219 minutes.</summary> -->
<!-- </details> -->

### Bivariate Analysis

#### How do delays vary across time?

This question involves a longitudinal analysis of the evolution of delayed flights over 34 years. It compares the continuous variable "number of delayed flights" with the categorical time variable, examining both departure and arrival delays

To answer this question, I first defined the time step by which to evaluate the evolution of delays. I chose to aggregate the data by month-year date, which provides a balance between granularity, interpretability and computational efficiency. Next, I decided on the metric to evaluate delays. Although the raw sum of delays is intuitive, normalizing the counts by the total flights per month offers a more accurate representation of delay frequency, as it adjusts for variations in monthly flight numbers.

With these definitions, I began by plotting the evolution in the number of delayed flights per month over the years, as shown in the figure below. 

![](/assets/projects/airline/evolution-mean-delays.png)

The normalized plots above reveal several insights about the evolution of delays from a cross-sectional and longitudinal perspective:

- **Cross-sectional observations**:
  * The line plot reveals periodic fluctuations in both departure and arrival delays, reflecting seasonal changes in delays within each year.
  * A noticeable drop in delays occurs between approximately 2001 and 2003, potentially influenced by external economic factors^[One potential cause for this temporary drop in delays is the contraction in the airline industry that followed 9/11, reducing the amount of delays together with the number of flights (see [this article](https://www.businessinsider.com/how-the-us-airline-industry-has-changed-since-911-2011-9?op=1))].
- **Longitudinal observations**:
  * The regression plot shows an initial gap between departure and arrival delays, which converges over time to approximately 20% by the end of the dataset.
  * The line plot demonstrates a reduction in the volatility of delays over the years, suggesting a slight stabilization in the frequency of delays.

This narrowing gap and reduction in delay volatility would have suggested an improvement in airline on-time performance, if it were not for the fact that the reduction is cause by an increase in departure delays rather than a decrease in arrival delays. The regression analysis demonstrates this: arrival delays have decreased only by 1%, while departure delays have risen by over 5% in the span of 30 years. This confirms that airlines have been unable to improve on-time performance at arrivals and have become less efficient in managing departure delays.

#### Are departures delays correlated with arrival delays?

This question is a correlation analysis examining the connection between the two continuous variables: departure and arrival delays. 

To answer this, I calculated the Pearson correlation coefficient between departure delays and arrival delays for delayed flights^[I filtered the dataset for flights with delays greater than 15 minutes, the industry standard for defining a delayed flight. This prevents the distribution from factoring in flights that were not delayed, which account for the majority of the dataset and may skew the results.]. This coefficient ranges from -1 indicating a perfect negative linear relationship, 0 indicating no linear relationship, up to 1 indicating a perfect positive linear relationship. To visualize the relationship, I plot the correlation using a custom `jointplot` function, which combines a scatter plot with a box plot to show the distribution of the data across both variables. This function also computes and displays the Pearson correlation coefficient.

Before plotting the jointplot, I cleaned the data by removing the remaining extreme cases, such as flights with negative delays which, due to times crossing the change to daylight savings time, were not corrected in the preprocessing. After this, I plotted the jointplot, which is shown below.

![](/assets/projects/airline/delays-correlation.png)

The Pearson correlation coefficient between departure and arrival delays is 0.93, indicating a strong positive linear relationship between the two variables. However, there are three observations that can be made from the jointplot:

1. **Outliers and Extreme Cases**: The scatter plot exhibits a broad spectrum of outliers that extend well beyond the interquartile range, yet notably adhere to the linear relationship between departure and arrival delays.
2. **Linear Relationship**: The distribution shows that the relationship follows a more linear pattern the more extreme their values are, whereas the relationship becomes more dispersed as delays become less extreme.
3. **Interquartile Rangel**: The interquartile range for both departure and arrival delays is notably narrower compared to the full range of the data, which underscores the concentration of delays within 60 minutes, as seen in the univariate analysis.

To understand the nature of this relationship for the core of flights, I focused on the interquartile range and adjusted the analysis: recalculating the correlation coefficient and focusing the jointplot on this range.

![](/assets/projects/airline/delays-correlation-filtered.png)

The Pearson correlation coefficient is now 0.67 within the interquartile range, which indicates a weaker but still positive linear relationship between departure and arrival delays. This relationship is depicted in the jointplot by a broader dispersion of data points. The empty square in the lower left corner of the plot represents flights filtered out by the industry standard definition of a delay (>15 minutes). The boxplots along the edges of the scatterplot further confirm the findings from the univariate analysis, namely that the majority of delays range between 15 and 40 minutes.

The filtered scatterplot has two clear boundaries that define the relationship between departure and arrival delays. I calculated approximate regression lines for these boundaries to understand the relationship more clearly. 

![](/assets/projects/airline/delays-correlation-filtered-bounds.png)

There are two observations that can be made about the correlation of departure and arrival delays for the interquartile range:

- **Shallow Bound**: Indicates the minimum threshold to which arrival delays can be minimized.
  * Follows a linear relationship: $y = 1.15x - 45$, where $y$ is the arrival delay and $x$ is the departure delay.
  * Implies that the arrival delay can only be reduced by up to 45 minutes relative to a departure delay.
  * Highlights a practical limit: minimizing arrival delays becomes increasingly constrained as departure delays increase.
- **Steep Bound**: Indicates how arrival delays can increase relative to departure delays.
  * Follows a steeper linear trend: $y = 6.5x + 120$, where $y$ is the arrival delay and $x$ is the departure delay.
  * Reflects that arrival delays can significantly exceed departure delays due to extrenal factors like diversions, weather, or arrival airport congestion.
  * Bound shows an upper limit of 250 minutes for on-time departures (see first scatterplot), then progressively aligning with the general trend as departure delays increase.

In conclusion, the correlation analysis reveals a moderately positive linear relationship between departure and arrival delays when focusing on the interquartile range. The broad dispersion of data points suggests variability influenced by external factors affecting arrival delays relative to departure delays. This dispersion is marked by two boundaries: arrival delays can be minimized by up to 45 minutes relative to departure delays, yet can exceed them by up to 250 minutes. Otherwise, when considering the full range of data, the analysis demonstrates a strong positive linear relationship between departure and arrival delays.

#### How do delays vary across carriers?

This is one of the most frequently asked questions in the airline industry, as it provides insights into the performance of individual carriers. It requires a bivariate analysis comparing the frequency of delays across carriers. Most reports approach this question by comparing the total number of delays per carrier, but this approach can be misleading for two reasons:

1. **Flight Volume**: Carriers with higher flight volumes are more likely to have higher delay counts, which can skew the results.
2. **Carrier Age**: Older carriers have more historical data, which can also skew the results.

This analysis uses a more accurate metric: the normalized delay frequency. This metric adjusts the delay counts by the total number of flights per carrier^[An alternative approach would be to normalize the counts by the age of the carrier. However, this would require data mapping each carrier to its age in the industry, which at the time of writing this report, was not available for the carriers in this dataset.]. This approach provides a more accurate representation of delay frequency, as it accounts for variations in flight volume and carrier age. Below are the plots of the normalized delay frequencies across carriers.

![](/assets/projects/airline/departure-delays-carrier.png)
![](/assets/projects/airline/arrival-delays-carrier.png)

The normalized delay counts shown in the bar plots now provide a more accurate comparison of on-time performance between airlines. According to the data, the airline with the highest proportion of delays at departure is JetBlue Airways, followed by ExpressJet Airlines, Frontier Airlines, Allegiant Air, and Spirit Airlines. On the other hand, the airline with the highest proportion of delays at arrival is Piedmont Airlines, followed Ukraine International Airlines, JetBlue Airways, ExpressJet Airlines, Conair and Frontier Airlines.

#### How do delays vary by route and airport?

Both questions involve an analysis on the frequency of delays utilizing the same metric: flight paths. By visualizing the routes with the highest delays and observing patterns of flight path convergence, we can achieve two key insights:

1. **Routes with Highest Delays**: given by the frequency of delays across a given route.
2. **Airports with Highest Delays**: given by the convergens of high-delay routes at specific airports.

To tackle this question, I will visualize the routes with the highest departure and arrival delays, respectively, using X. I first aggregated the dataset by flight routes and normalize the total departure and arrival delays by the total number of flights for each route, to provide a more robust metric. I then mapped the routes onto two visualizations: one for departure delays and another for arrival delays. The resulting visualiations are shown below:

:::{.column-page-right}
<iframe src="_dep-delay-airports.html" width="100%" height="600px"></iframe>
<figcaption>Departure Delays by Airport (click legend to toggle groups)</figcaption>
:::

:::{.column-page-right}
<iframe src="_arr-delay-airports.html" width="100%" height="600px"></iframe>
<figcaption>Arrival Delays by Airport (click legend to toggle groups)</figcaption>
:::
